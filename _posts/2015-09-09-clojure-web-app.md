---
layout: post
title: 'Clojure Web App и логирование'
date: 2015-09-09 11:29
comments: true
categories: 
---
Приложение, которое я написал периодически переставало получать данные с ElasticSearch.

Соответственно, встал вопрос о логировании. Погуглив нашёл несколько статей. Выбрал на пробу 2 крайних варианта Timbre и Tools.Logging + Log4j.

# Timbre

Преподносится как наиболее простой способ, где не надо с самого начала утруждать себя кучей настроек.

На пробу оказалось всё не радужно.

Ну кому пришло в голову валить ANSI коды цветов прямо в logfile? Как до этого можно было додуматься?

# Tools.Logging + Log4j

В интернете полно статей как это настроить, но для того, кто не разбирался в том, как всё это устроено они годятся только в самом типовом случае.

Дело в том, что почти всюду написано, что `log4j.properties` надо класть в директорию `resources`. Но, видимо, чтобы это работало, `project.clj` (`build.boot` в моём случае) должен быть как-то уже настроен.

Но в одном [месте] (http://www.bahmanm.com/blogs/how-to-add-logging-to-a-clojure-project), я натолкнулся на упоминание, что файл с конфигурацией Log4j надо класть вместе с сорцами. В моём случае (да и вообще в случае web-приложения не Clojure) это в `src/clj`.

После этого логирование заработало.

По [ссылке] (http://brownsofa.org/blog/2015/06/14/clojure-in-production-logging/) есть несколько функций, чтобы менять конфигурацию логирования в runtime.